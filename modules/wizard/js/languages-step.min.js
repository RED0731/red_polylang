jQuery(document).ready(function(a){var e=a(".languages-step"),l=a("#language-fields"),n=a("#languages"),t=a("#languages tbody"),r=a("#defined-languages tbody"),i=a("#lang_list"),d=a('[name="save_step"]'),s=a("#messages"),g=new Map,o=a("#dialog");function c(e){var r=a("<td />").text(e.text).prepend(e.flagUrl),d=a("<td />").append(a("<span />").addClass("dashicons dashicons-trash").attr("data-language",e.locale).append(a("<span />").addClass("screen-reader-text").text(pll_wizard_params.i18n_remove_language_icon))),s=a("<tr />").prepend(d).prepend(r),o=a("<input />").attr({type:"hidden",name:"languages[]"}).val(e.locale);i.val(""),i.selectmenu("refresh"),g.set(e.locale,e),t.append(s),t.on("click","span[data-language="+e.locale+"]",function(e){e.preventDefault(),a(this).parents("tr").remove(),languageField=l.children("input[value="+a(this).data("language")+"]").remove(),t.children().length<=0&&n.hide(),g.delete(a(this).data("language")),_()}),l.append(o)}function u(e){s.empty(),s.prepend(a("<p/>").addClass("error").text(e))}function _(){s.empty(),e.find(".error").removeClass("error field-in-error")}function p(a){a.focus()}a("#add-language").on("click",function(e){_();var l=e.currentTarget.form.lang_list.options[e.currentTarget.form.lang_list.selectedIndex];if(""===l.value||g.has(l.value)){var t=pll_wizard_params.i18n_no_language_selected;g.has(l.value)&&(t=pll_wizard_params.i18n_language_already_added),u(t),i.next("span.ui-selectmenu-button").addClass("error field-in-error"),p(a("#lang_list-button"))}else c({locale:l.value,text:l.innerText,name:a(l).data("language-name"),flagUrl:a(l).data("flag-html")}),n.show(),p(a("#lang_list-button"))}),e.on("submit",function(e){var l=r.children().length>0;return g.size<=0&&!l?(""===a("#lang_list").val()?(u(pll_wizard_params.i18n_no_language_added),p(a("#lang_list-button"))):(u(pll_wizard_params.i18n_add_language_needed),p(a("#add-language"))),!1):""!==a("#lang_list").val()?(o.dialog("open"),!1):void 0});var m=new URLSearchParams(document.location.search);function f(e){switch(e){case"yes":var l=a("#lang_list").children(":selected");c({locale:l[0].value,text:l[0].innerText,name:a(l).data("language-name"),flagUrl:a(l).data("flag-html")}),d.click();break;case"no":i.val(""),d.click()}o.dialog("close"),"ignore"===e&&p(a("#lang_list-button"))}m.has("activate_error")&&void 0!==pll_wizard_params[m.get("activate_error")]&&u(pll_wizard_params[m.get("activate_error")]),o.dialog({autoOpen:!1,modal:!0,draggable:!1,resizable:!1,title:pll_wizard_params.i18n_dialog_title,minWidth:600,maxWidth:"100%",open:function(e,l){a("#dialog-language").text(a("#lang_list").children(":selected")[0].innerText),a("#dialog-language").prepend(a("#lang_list").children(":selected").data("flag-html"))},buttons:[{text:pll_wizard_params.i18n_dialog_yes_button,click:function(a){f("yes")}},{text:pll_wizard_params.i18n_dialog_no_button,click:function(a){f("no")}},{text:pll_wizard_params.i18n_dialog_ignore_button,click:function(a){f("ignore")}}]})});
